## Database > RDS for MS-SQL > コンソール使用ガイド

## DBインスタンス

DBインスタンスタブではDBインスタンスの作成、修正、削除などの作業を行ったり、作成されたDBインスタンスの各種状態情報を照会できます。

### DBインスタンス作成

DBインスタンスを作成するには、先にDBインスタンスリスト画面左上の[DBインスタンス作成]ボタンを押して、DBインスタンス作成画面へ移動します。
作成したいDBインスタンスの仕様、情報、ネットワーク、Floating IP、DBセキュリティグループ、バックアップ設定を入力した後、[DBインスタンス作成]ボタンを押してDBインスタンス作成リクエストを行います。

![DBインスタンス作成001](http://static.toastoven.net/prod_rds_mssql/20201215/bordered/db_instance_create_001_kr.png)

* ❶ Compute & Networkサービスで作成したVPCサブネットを選択できます。
* ❷ DBセキュリティグループがない場合、[DBセキュリティグループ作成]ボタンを押して即時に作成し、適用できます。
* その他詳細については[DBインスタンス](./db-instance)と[データベース接続](./database-connection)を参照してください。

DBインスタンス作成リクエストが成功すると、自動的にDBインスタンスリストへ移動します。DBインスタンスの作成には数分から数十分かかります。

### DBインスタンスリスト

DBインスタンスの簡略な情報リストを照会できます。 
1画面に最大50個のDBインスタンスリストが表示されます。 

![DBインスタンスリスト001](http://static.toastoven.net/prod_rds_mssql/db_instance_list_001.png)

* ❶ DBインスタンス名およびUUIDで検索できます。
* ❷条件ボタンを押すと、アベイラビリティゾーンとDBインスタンス状態で検索結果をフィルタリングできます。

![DBインスタンスリスト > 条件001](http://static.toastoven.net/prod_rds_mssql/20201215/bordered/db_instance_list_cond_001_kr.png)

* ❸ DBインスタンス選択時、DBインスタンスの状態に応じて有効になります。
* ❹現在のリストを更新するか、50個以上のDBインスタンスがある場合、ページを移動できます。
* ❺現在のCPU使用量とアクティブセッション数を表します。この値は1分毎に更新されます。
* ❻ DBインスタンスの状態を表します。状態によって異なる状態値、色が表示されます。DBインスタンスが作業中の場合、スピナーが表示されます。

### DBインスタンス再起動

DBインスタンスのMicrosoft SQL Serverプロセスを再起動できます。 DBインスタンスが高可用性構成を使用すると、フェイルオーバーを利用して再起動できます。

![DBインスタンスリスト > 再起動001](http://static.toastoven.net/prod_rds_mssql/20201215/bordered/db_instance_restart_001_kr.png)

* ❶ DBインスタンスを再起動すると、Microsoft SQL Serverプロセスを再起動します。もしMicrosoft SQL Serverプロセスの再起動に失敗したら、DBインスタンスVMが再起動します。
* ❷高可用性機能を使用する場合、フェイルオーバーを利用して再起動する場合もあります。

### DBインスタンス修正

使用可能状態のDBインスタンスは、Webコンソールから簡単に主な設定を変更でます。

![DBインスタンスリスト002](http://static.toastoven.net/prod_rds_mssql/20201215/bordered/db_instance_list_002_kr.png)

* ❶修正したいDBインスタンスをリストから選択して、左上の修正ボタンを押します。

変更したい設定を変更後、ページ下の[修正]ボタンを押してDBインスタンスを修正します。
DBインスタンス修正リクエストが成功すると、自動的にDBインスタンスリストへ移動します。DBインスタンスの修正は数分から数十分かかります。

![DBインスタンス修正001](http://static.toastoven.net/prod_rds_mssql/20201215/bordered/db_instance_modify_001_kr.png)

* ❶アベイラビリティゾーンは変更できません。
* ❷ DBインスタンスタイプ変更時、データベースが再起動します。
* ❸ストレージタイプは変更できません。
* ❹一度増やしたストレージサイズは減らせません。
* ❺バックアップ保管期間が1日以上の時のみ、高可用性機能を使用できます。
* ❻ユーザーIDは変更できません。
* ❼変更するにはパスワードを入力する必要があります。
* ❽ポート変更時、データベースが再起動します。
* ❾VPCは変更できません。

### DBインスタンス詳細

DBインスタンスを選択すると、画面下に詳細表示パネルが表示され、さらに詳細な情報を確認できます。
詳細表示パネルは5つのタブで構成されていて、DBインスタンスに関連した追加情報を確認できます。

#### 基本情報

選択したDBインスタンスの基本情報を確認できます。

![DBインスタンス詳細 > 基本情報001](http://static.toastoven.net/prod_rds_mssql/20201215/bordered/db_instance_detail_inst_001_kr.png)

* ❶ [変更]ボタンを押すと、DBインスタンスの名前を変更できます。
* ❷ [コピー]ボタンを押すと、DBインスタンスのIDをクリップボードにコピーします。
* ❸ DBインスタンスに接続できるドメインが表示されます。ドメインをクリックすると、ドメインのタイプとIP情報が表示されます。

![DBインスタンス詳細 > 基本情報001ドメイン](http://static.toastoven.net/prod_rds_mssql/20201215/bordered/db_instance_detail_inst_001_domain_kr.png)

* ❹ [コピー]ボタンを押すと、ドメイン情報をクリップボードにコピーします。
* ❺適用されたDBセキュリティグループを確認できます。DBセキュリティグループ名の上にマウスオーバーすると、セキュリティグループルールが表示されます。

![DBインスタンス詳細 > 基本情報001セキュリティルール](http://static.toastoven.net/prod_rds_mssql/20201215/bordered/db_instance_detail_inst_001_dsg_kr.png)

#### モニタリング

選択したDBインスタンスに関連する指標をチャートで確認できます。詳細な使用方法は[サーバーダッシュボード](./console-guide#_20)を参照してください。

![DBインスタンス詳細 > モニタリング001](http://static.toastoven.net/prod_rds_mssql/db_instance_detail_mon_001.png)

#### イベント

選択したDBインスタンスに関連するイベントを確認できます。詳細な使用方法は[イベント](./console-guide#_12)を参照してください。

![DBインスタンス詳細 > イベント001](http://static.toastoven.net/prod_rds_mssql/db_instance_detail_event_001.png)

#### ログ

選択したDBインスタンスで発生したMicrosoft SQL Serverのエラーログを確認できます。 
エラーログの内容を新しい順にソートし、1画面で最大10行のエラーログを確認できます。

![DBインスタンス詳細 > ログ001](http://static.toastoven.net/prod_rds_mssql/db_instance_detail_log_001.png)

* ❶照会期間を選択します。別途指定しなければ直近一週間のエラーログを照会します。
* ❷照会期間をデフォルト値に初期化します。
* ❸現在のリストを更新するか、10行以上のエラーログがある場合、ページを移動できます。

#### バックアップ

選択したDBインスタンスのバックアップ関連設定情報および、バックアップファイルの情報を確認できます。
1画面に最大50個のバックアップリストが表示されます。 

![DBインスタンス詳細 > バックアップ001](http://static.toastoven.net/prod_rds_mssql/db_instance_detail_backup_001.png)

* ❶バックアップ実行時間が表示されます。バックアップ実行時間を指定しなかった場合、システムで指定した時間が表示されます。
* ❷最後に実行されたバックアップの作成時刻が表示されます。
* ❸バックアップ名で検索できます。
* ❹選択したバックアップを利用してDBインスタンスを復元します。
* ❺選択したバックアップを削除します。手動バックアップのみ削除できます。
* ❻手動バックアップファイルを作成します。
* ❼現在のリストを更新するか、50個以上のバックアップファイルがある場合、ページを移動できます。

## バックアップ

バックアップタブではすべてのDBインスタンスの手動、自動バックアップファイルの情報を確認できます。

### バックアップリスト

![バックアップリスト001](http://static.toastoven.net/prod_rds_mssql/backup_list_001.png)

* ❶バックアップ名で検索できます。
* ❷選択したバックアップを利用してDBインスタンスを復元します。
* ❸選択したバックアップを削除します。手動バックアップのみ削除できます。
* ❹手動バックアップファイルを作成します。
* ❺現在のリストを更新するか、50個以上のバックアップファイルがある場合、ページを移動できます。

### バックアップ作成

バックアップタブの[バックアップ作成]ボタンを押すと、バックアップを作成するためのポップアップが表示されます。
DBインスタンスを選択し、名前を入力した後、[作成]ボタンを押すとバックアップが実行されます。

![バックアップリスト002](http://static.toastoven.net/prod_rds_mssql/backup_list_002.png)

* ❶バックアップするDBインスタンスを選択します。現在使用可能なDBインスタンスのみ表示されます。
* ❷バックアップ名を入力します。
* その他、詳細事項は[バックアップおよび復元](./backup-restore)を参照してください。

## 復元

RDS for MS-SQLではバックアップを利用した復元と時点復元をサポートします。
復元の詳細については[バックアップおよび復元](./backup-restore)を参照してください。

### バックアップを利用した復元

バックアップタブまたはDBインスタンス詳細表示パネルのバックアップタブで、バックアップを利用して復元を行うことができます。
復元に使用するバックアップをリストから選択し、[復元]ボタンを押すと復元画面に移動します。

![復元001](http://static.toastoven.net/prod_rds_mssql/restore_001.png)
![復元002](http://static.toastoven.net/prod_rds_mssql/restore_002.png)

復元画面で新たに作成されるDBインスタンスのタイプおよび各種設定を行った後、画面下の[DBインスタンス復元]ボタンを押してDBインスタンスを復元します。
バックアップが行われた時点のDBインスタンスタイプ、ストレージタイプ、ストレージサイズ、ポート、パラメータグループおよびDBセキュリティグループが自動的に選択されます。

> [注意]
> バックアップ時点のパラメータグループが存在しない場合、基本パラメータグループが選択されます。
> バックアップ時点に存在するDBセキュリティグループのみ自動的に選択されます。

![復元003](http://static.toastoven.net/prod_rds_mssql/restore_003.png)

DBインスタンスの復元には数分から数十分かかります。

### バックアップ保管期間中の任意の時点に復元

DBインスタンスのバックアップ保管周期が1日以上の場合、バックアップ保管期間中の任意の時点に復元できます。
時点復元するDBインスタンスを選択した後、[時点復元]ボタンを押すと復元画面に移動します。

![復元004](http://static.toastoven.net/prod_rds_mssql/restore_004.png)

バックアップを利用した復元と同じ画面ですが、画面上部で復元する時点を選択できます。

![復元005](http://static.toastoven.net/prod_rds_mssql/restore_005.png)

最近の復元可能時刻ではなく、他の時点に復元するには[ユーザー指定]を選択します。

![復元006](http://static.toastoven.net/prod_rds_mssql/restore_006.png)

復元画面で新たに作成されるDBインスタンスのタイプおよび各種設定を行った後、画面下の[DBインスタンス復元]ボタンを押してDBインスタンスを復元します。
DBインスタンスの復元には数分から数十分かかります。

## イベント

イベントタブでは最近発生したイベントの確認や、イベント購読に関する設定を行うことができます。
イベントと購読の詳細については[モニタリング](./monitoring#_2)を参照してください。

### 最近のイベントリスト

最近発生したイベントを確認できます。一度に50個のイベントが表示され、多様な条件でフィルタリングできます。

![最近のイベントリスト001](http://static.toastoven.net/prod_rds_mssql/event_list_001.png)

* ❶表示されるイベントタイプを選択します。
* ❷検索ワードで検索する対象を選択します。イベントソースおよびメッセージで検索できます。
* ❸表示されたイベント発生日時を選択します。
* ❹ [初期化]ボタンを押すと、すべての検索条件をデフォルト値に設定します。
* ❺現在のリストを更新するか、50個以上のイベントがある場合、ページを移動できます。

### イベントを購読する

イベント購読リスト上部の[イベント購読登録]ボタンを押すと、ポップアップが表示されます。
購読するイベント情報を入力し、ポップアップ下部の[作成]ボタンを押すと、イベントを購読できます。

![イベント購読ポップアップ001](http://static.toastoven.net/prod_rds_mssql/event_subscription_001.png)

* ❶イベントタイプに応じてイベントコード、イベントソースをさらに細分化して選択できます。
* ❷プロジェクトのメンバーのみユーザーリストに表示されます。実名認証を行ったメンバーのみ名前とSMSが追加で表示されます。

![イベント購読ポップアップ002](http://static.toastoven.net/prod_rds_mssql/event_subscription_002.png)

* イベントタイプを選択すると、選択したタイプに属しているイベントコードを選択できます。

![イベント購読ポップアップ003](http://static.toastoven.net/prod_rds_mssql/event_subscription_003.png)

* ❶オートコンプリート入力をサポートします。
    * 入力したキーワードに応じて、選択できるイベントコードがフィルタリングされます。
    * キーボードの上下方向キーでイベントコードを選択した後、Enterを押すと、オートコンプリートされます。
    * 追加されたイベントコードは、Backspaceを押すか、[x]ボタンを押すと削除できます。
* ❷マウスでイベントコードを選択できます。

![イベント購読ポップアップ004](http://static.toastoven.net/prod_rds_mssql/event_subscription_004.png)

* イベントタイプに応じてイベントソースが表示されます。
* ❶オートコンプリート入力をサポートします。
    * 入力したキーワードに応じて、選択できるイベントソースがフィルタリングされます。
    * キーボードの上下方向キーでイベントソースを選択した後、Enterを押すとオートコンプリートされます。
    * 追加されたイベントソースは、Backspaceを押すか、[x]ボタンを押すと削除できます。
* ❷マウスでイベントソースを選択できます。

## パラメータグループ

パラメータタブでは、DBインスタンスに適用するパラメータグループの作成や、パラメータグループのパラメータの修正を行うことができます。

### パラメータグループ作成

パラメータグループを作成するには、既存パラメータグループからデフォルト値をコピーする必要があります。
パラメータグループリストからコピーしたい対象を先に選択した後、[パラメータグループコピー]ボタンを押します。

![パラメータグループリスト001](http://static.toastoven.net/prod_rds_mssql/parameter_group_list_001.png)

新たに作成するパラメータグループの名前および説明を入力した後、[コピー]ボタンを押して新しいパラメータグループを作成できます。

![パラメータグループコピー001](http://static.toastoven.net/prod_rds_mssql/parameter_group_copy_001.png)

### パラメータグループ修正

パラメータグループリストから修正したい対象の名前を押して、パラメータ詳細画面に移動します。

![パラメータグループリスト002](http://static.toastoven.net/prod_rds_mssql/parameter_group_list_002.png)

パラメータ詳細画面の上部にある[パラメータ編集]ボタンを押して編集モードへ移行します。

![パラメータグループ詳細001](http://static.toastoven.net/prod_rds_mssql/parameter_group_detail_001.png)

パラメータを修正し、[変更事項保存]ボタンを押してパラメータグループのパラメータを修正します。

![パラメータグループ詳細002](http://static.toastoven.net/prod_rds_mssql/parameter_group_detail_002.png)

* ❶キーワードを入力して、表示されるパラメータをフィルタリングできます。
* ❷現在まで修正されたすべてのパラメータ変更事項をキャンセルし、詳細画面へ移動します。
* ❸変更前と後の比較結果がポップアップで表示されます。

![パラメータグループ詳細003](http://static.toastoven.net/prod_rds_mssql/parameter_group_detail_003.png)

* ❹すべてのパラメータの値をデフォルト値に初期化します。
* ❺❻パラメータ修正プロセスで発生したエラーメッセージが表示されます。

### パラメータグループ比較

異なる2個のパラメータグループを比較して、異なるパラメータ値が何かを確認できます。
パラメータリストから比較したいパラメータグループ2個を選択します。

![パラメータグループリスト003](http://static.toastoven.net/prod_rds_mssql/parameter_group_list_003.png)

上部の[パラメータグループ比較]ボタンを押して、異なるパラメータの値を確認します。

![パラメータグループ比較001](http://static.toastoven.net/prod_rds_mssql/parameter_group_diff_001.png)

## DBセキュリティグループ

DBセキュリティグループタブでは、DBセキュリティグループの作成および削除を行うことができます。また、DBセキュリティグループにポリシーを追加、修正、削除できます。
DBセキュリティグループの詳細については[データベース接続](./database-connection)を参照してください。

### DBセキュリティグループ作成

DBセキュリティグループリスト上部の[DBセキュリティグループ作成]ボタンを押すと、DBセキュリティグループを作成することができるポップアップが表示されます。

![DBセキュリティグループリスト001](http://static.toastoven.net/prod_rds_mssql/db_security_group_list_001.png)
![DBセキュリティグループ作成001](http://static.toastoven.net/prod_rds_mssql/db_security_group_create_001.png)

* ❶ [+]ボタンを押してセキュリティポリシーを追加します。

ポップアップ下部の[確認]ボタンを押してDBセキュリティグループを作成します。

### DBセキュリティグループ修正

DBセキュリティグループリストから修正したいDBセキュリティグループを選択し、上部の[DBセキュリティグループ変更]ボタンを押します。

![DBセキュリティグループ修正001](http://static.toastoven.net/prod_rds_mssql/db_security_group_modify_001.png)

DBセキュリティグループの名前と説明を修正できます。セキュリティポリシーは別途修正する必要があります。

### セキュリティポリシー修正

DBセキュリティグループリストからDBセキュリティグループを選択すると、画面下部にセキュリティポリシーを確認、修正することができる詳細表示パネルが表示されます。

![DBセキュリティグループ詳細001](http://static.toastoven.net/prod_rds_mssql/db_security_group_detail_001.png)

詳細表示パネルの[セキュリティポリシー作成]ボタンを押すと、セキュリティポリシーを作成することができるポップアップが表示されます。

![DBセキュリティグループ詳細002](http://static.toastoven.net/prod_rds_mssql/db_security_group_detail_002.png)

詳細表示パネルでDBセキュリティグループポリシーを選択すると、ポリシーを変更、削除できます。

## サーバーダッシュボード

サーバーダッシュボードタブでは、DBインスタンスの各種性能指標をチャートで確認できます。
RDS for MS-SQLは、基本システム指標および基本SQLサーバー指標、2個の基本レイアウトを提供します。
基本レイアウトは削除および変更ができません。

![サーバーダッシュボード001](http://static.toastoven.net/prod_rds_mssql/server_dashboard_list_001.png)

* ❶作成されたDBインスタンスがリストに表示されます。DBインスタンス選択時、関連するチャートを確認できます。
* ❷レイアウトを変更して、新しい指標を確認できます。
* ❸チャート照会期間を現在時刻基準で設定します。

### ユーザーレイアウトの活用

[レイアウト作成]ボタンを押して、レイアウトを新たに作成できます。

![サーバーダッシュボード002](http://static.toastoven.net/prod_rds_mssql/server_dashboard_list_002.png)

![サーバーダッシュボード003](http://static.toastoven.net/prod_rds_mssql/server_dashboard_list_003.png)

新たに作成したレイアウトに、見たいチャートを追加できます。

![サーバーダッシュボード004](http://static.toastoven.net/prod_rds_mssql/server_dashboard_list_004.png)

レイアウトを選択した後、[チャート追加]ボタンを押すと、チャート追加ポップアップが表示されます。

![サーバーダッシュボード005](http://static.toastoven.net/prod_rds_mssql/server_dashboard_list_005.png)

チャートを追加すると、レイアウトにチャートが追加されます。

![サーバーダッシュボード006](http://static.toastoven.net/prod_rds_mssql/server_dashboard_list_006.png)

ユーザーレイアウトのチャートは、自由に配置やサイズを変更できます。

![サーバーダッシュボード007](http://static.toastoven.net/prod_rds_mssql/server_dashboard_list_007.png)

* ❶ 1番領域をマウスでドラッグ&ドロップして位置を変更できます。
* ❷右下の領域をマウスでドラッグ&ドロップしてサイズを変更できます。
* ❸追加したチャートを削除できます。
